# IP探测工具 - 资产识别

一个基于Python的IP探测工具，用于识别网络中的在线设备和资产，支持多种扫描方式和灵活的配置选项。

## 功能特点

### 核心功能
- **综合扫描方式**：结合ARP扫描、ping扫描和TCP SYN扫描，提高检测准确性
- **MAC地址获取**：自动获取在线设备的MAC地址
- **资产识别**：识别网络中正在使用的IP和设备
- **状态分类**：
  - 在线：当前可以正常通信的设备
  - 离线：曾经在线过（有MAC记录）但当前不可达的设备
  - 未使用：从未使用过的IP地址

### 扫描性能
- **多线程支持**：1-100线程可调整，适应不同网络环境
- **高效扫描**：优先使用ARP扫描，速度快，资源占用低
- **防止丢包**：结合多种扫描方式，减少因丢包导致的误判

### 用户体验
- **友好的GUI界面**：简洁直观的操作界面
- **拉伸自适应**：支持窗口大小调整，所有元素自动适应
- **结果排序**：
  - IP地址：按数字顺序排序（1-254）
  - 状态：按在线 > 离线 > 未使用顺序排序
  - 支持升序/降序切换
- **结果导出**：支持导出为Excel文件，文件名使用扫描的IP段
- **实时日志**：详细记录扫描过程和结果

## 支持的IP输入格式

- 单个IP：如 `192.168.1.1`
- IP范围：如 `192.168.1.1-20`
- 完整IP范围：如 `192.168.1.1-192.168.1.100`
- CIDR网段：如 `192.168.1.0/24`

## 安装方法

### 1. 安装Python
确保系统已安装Python 3.7或更高版本。

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

## 使用说明

### 运行工具
```bash
python ip_prober.py
```

### 基本操作
1. 在"IP地址或地址段"输入框中输入要探测的IP范围
2. 在"线程数"输入框中设置合适的线程数
3. 点击"开始探测"按钮启动扫描
4. 扫描过程中可以点击"停止探测"按钮中断扫描
5. 扫描完成后：
   - 点击列标题进行排序
   - 点击"导出结果"按钮将结果保存为Excel文件

### 线程数建议
- 小网络（<100个IP）：10-20线程
- 中等网络（100-1000个IP）：20-50线程
- 大网络（>1000个IP）：50-100线程
- 网络环境好时可适当增加线程数
- 网络环境差时建议减少线程数

## 导出文件

### 文件名格式
- 格式：`{IP段}_probe_result.xlsx`
- 例如：扫描 `192.168.1.1-20`，导出文件名为 `192.168.1.1-20_probe_result.xlsx`

### 导出内容
- IP地址：设备的IP地址
- 状态：在线/离线/未使用
- MAC地址：设备的物理地址

## 技术实现

### 扫描机制
1. **ARP扫描**：优先使用ARP协议进行扫描，效率高且能直接获取MAC地址
2. **ping扫描**：对ARP扫描失败的IP进行ping扫描，防止丢包情况
3. **TCP SYN扫描**：对ARP和ping扫描失败的IP，扫描常用端口（80, 443, 22, 23, 3389, 21）

### 状态判断逻辑
- 如果ARP扫描成功，状态为"在线"
- 如果ARP扫描失败但ping或TCP SYN扫描成功，状态为"在线"
- 如果都失败但有MAC地址，状态为"离线"
- 如果都失败且没有MAC地址，状态为"未使用"

## 注意事项

1. **权限要求**：
   - 部分功能（如ARP扫描）可能需要管理员权限
   - 建议以管理员身份运行命令行或IDE

2. **网络环境**：
   - 工具主要用于局域网扫描
   - 跨网段扫描可能受到路由器或防火墙限制
   - 部分设备可能禁用ICMP或常用端口，影响探测结果

3. **结果解读**：
   - "离线"状态表示设备曾经在线过，但当前不可达
   - "未使用"状态表示该IP从未被使用过
   - 建议结合实际网络环境解读结果

4. **性能优化**：
   - 大网络扫描时，建议适当减少线程数，避免网络拥堵
   - 长时间扫描时，建议定期保存结果

## 系统要求

- 操作系统：Windows 7/8/10/11
- Python版本：3.7或更高
- 依赖库：openpyxl

## 更新日志

### v1.0.0
- 初始版本
- 支持ARP扫描、ping扫描和TCP SYN扫描
- 多线程支持
- GUI界面
- 结果排序和导出功能

## 许可证

本项目采用MIT许可证，可自由使用、修改和分发。

## 贡献

欢迎提交Issue和Pull Request，共同改进这个工具。

---

**使用说明**：
1. 确保已安装Python 3.7或更高版本
2. 安装依赖：`pip install -r requirements.txt`
3. 运行工具：`python ip_prober.py`
4. 在界面中输入IP范围，设置线程数，点击"开始探测"
5. 扫描完成后可对结果进行排序和导出

祝您使用愉快！